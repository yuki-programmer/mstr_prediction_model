# MSTR株価予測システム - プロジェクトコンテキスト

## プロジェクト概要

### 目的
マイクロストラテジー(MSTR)の株価動向を予測し、投資判断を支援するシステムの開発

### 背景
- MSTRは大量のビットコインを保有する企業として知られる
- 従来の株価予測手法では、ビットコイン価格との特殊な相関関係を十分に捉えられない
- 複数の時間軸での予測により、短期・中期・長期の投資戦略に対応

## システム仕様

### 予測対象
- **銘柄**: MicroStrategy Inc. (NASDAQ: MSTR)
- **予測期間**: 5段階の時間軸
  - 超短期: 7日
  - 短期: 14日
  - 中短期: 30日
  - 中期: 90日
  - 中長期: 180日

### 使用データ
- **BTC (Bitcoin)**: 主要な相関指標（独立した物理的手法による予測も実施）
- **MSTR**: 最終予測対象
- **Gold**: 代替投資資産としての参考指標
- **データ形式**: ヒストリカルデータ（日次）

### 二段階予測アプローチ
1. **BTC価格予測**: 物理的手法による独立した予測モデル
2. **MSTR価格予測**: BTC予測結果とパターン一致ラグ相関分析を組み合わせた予測

## 核心技術1: BTC物理的予測手法

### 概念
BTCの価格動向を物理学的アプローチで予測する独立したモデル
（具体的なアルゴリズムは別途定義予定）

### 特徴
- **独立性**: MSTR予測とは独立したBTC専用の予測エンジン
- **物理的根拠**: 物理法則に基づく価格動向の予測
- **基盤予測**: MSTR予測の基盤となる重要な入力データを提供

## 核心技術2: パターン一致ラグ相関分析

### 概念
従来の同時期相関分析ではなく、BTCの価格動向がMSTRに影響する「時間差（ラグ）」を動的に検出し、パターンマッチングを行う独自アルゴリズム

### 構成要素
1. **方向性変換器**: 価格データを方向性（上昇/下降）パターンに変換
2. **パターン一致検出**: 類似パターンの識別
3. **最適ラグ検出**: BTCとMSTRの最適な時間差を発見
4. **複数期間分析**: 異なる時間軸での一貫性を検証

### 特徴
- 静的な相関係数ではなく、動的なパターン相関を分析
- 市場環境の変化に応じてラグ時間が調整される
- 複数期間での整合性チェックにより予測精度を向上

## アーキテクチャ設計

### 設計原則
1. **モジュラー設計**: 機能ごとに独立したモジュール構成
2. **設定駆動**: パラメータは外部設定ファイルで管理
3. **拡張性**: 新しい分析手法や予測期間を容易に追加可能
4. **テスト可能性**: 各モジュールが独立してテスト可能

### 主要モジュール
- **config/**: システム設定、分析パラメータ、予測パラメータ
- **data/**: データ読み込み、前処理、外部API接続
- **analysis/**: パターン分析、ベータ分析、BTCサイクル分析、整合性分析
- **prediction/**: 
  - **BTC予測**: 物理的手法によるBTC価格予測
  - **MSTR予測**: 複数期間予測、モンテカルロシミュレーション
- **decision/**: 投資判断、要因分析
- **visualization/**: ダッシュボード、チャート、レポート生成

## 金融・投資ドメイン知識

### MSTRの特性
- **ビットコイン保有企業**: 大量のBTCを企業資産として保有
- **価格連動性**: BTC価格変動がMSTR株価に直接的に影響
- **ボラティリティ**: 一般的な企業株より高いボラティリティを示す
- **機関投資家の注目**: ビットコインETFの代替投資先として注目

### 市場環境の考慮事項
- **取引時間**: 株式市場の取引時間制約（BTCは24時間取引）
- **市場センチメント**: 暗号通貨市場全体のセンチメントが影響
- **規制リスク**: 暗号通貨関連の規制変更リスク
- **流動性**: 機関投資家の大口取引による価格インパクト

## 技術的制約・要件

### 開発環境
- **言語**: Python 3.8+
- **主要ライブラリ**: pandas, numpy, scikit-learn, matplotlib等
- **コード品質**: 型ヒント必須、PEP 8準拠、docstring記載

### データ制約
- **データ欠損**: 休日・祝日のデータ欠損への対応
- **データ品質**: 異常値・外れ値の検出と処理

## 予測フロー

### 全体的な予測プロセス
1. **BTC独立予測**: 物理的手法によりBTCの将来価格を予測
2. **パターン分析**: 予測されたBTC価格パターンと過去のMSTR価格パターンを分析
3. **ラグ相関適用**: 最適なラグを考慮してMSTR価格を予測
4. **期間間整合性チェック**: 複数予測期間の結果整合性を検証
5. **投資判断生成**: 総合的な投資シグナルを生成

## 整合性分析の重要性

### 期間間整合性
異なる予測期間（7日〜180日）の結果が論理的に一貫しているかを検証

### 矛盾検出・説明
- 予測結果に矛盾がある場合の自動検出
- 矛盾の原因分析と説明生成
- 投資家への透明性確保

## リスク管理・免責事項

### システムの限界
- 過去データに基づく予測であり、将来を保証するものではない
- 市場の急激な変化（ブラックスワンイベント）は予測困難
- 予測精度には限界があることを常に考慮

### 投資判断支援の位置づけ
- 投資助言ではなく、判断材料の提供
- 最終的な投資判断は投資家の責任
- リスク許容度の個人差を考慮

## 詳細データスキーマ

システムの詳細なデータフロー・型定義は以下を参照：

- **データスキーマ概要**: `.claude/data_schemas/README.md`
- **パターン分析**: `.claude/data_schemas/pattern_analysis_schemas.md`
- **予測エンジン**: `.claude/data_schemas/prediction_schemas.md`
- **投資判断**: `.claude/data_schemas/decision_schemas.md`
- **共通型定義**: `.claude/data_schemas/common_types.md`

実装時は該当するスキーマファイルを必ず確認してください。

## 今後の拡張予定

### 追加予定機能
- **BTC物理的予測手法の実装**: 具体的なアルゴリズムの組み込み
- リアルタイムデータフィード対応
- 他の暗号通貨関連銘柄への拡張
- 機械学習モデルの導入検討
- ウェブダッシュボードの開発

### 改善予定項目
- 予測精度の継続的な向上
- ユーザーインターフェースの改良
- バックテスト機能の充実
- アラート機能の追加

---
**注意**: このドキュメントは開発進行に応じて継続的に更新されます。重要な設計決定や発見事項があった場合は、適宜このファイルに反映してください。